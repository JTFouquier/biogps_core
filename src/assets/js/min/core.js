(function(){setVisible=function(e,t){var n=e.style;n.visibility=t?"visible":"hidden"},String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},coreDispatcher={showWelcome:!0,delayedAction:null,biogpsLoaded:function(){return(window.biogps&&biogps.renderMainUI)!=null},delayedExecute:function(e){coreDispatcher.biogpsLoaded()?(ga("send","event","coreDispatcher.delayedExecute","callback",{nonInteraction:1}),e()):(ga("send","event","coreDispatcher.delayedExecute","delaying",{nonInteraction:1}),this.delayedAction=e)},isMainUICommand:function(e){if(!e||!e.toLowerCase)return!1;e=e.toLowerCase();var t=["genereport","mystuff","pluginlibrary","about","help","faq","downloads","terms"];for(var n=0;n<t.length;n++)if(e==t[n])return!0;return!1},dispatch:function(){var e=window.location.hash;if(e.length>0&&e.substring(0,1)=="#"){e=e.substring(1);var t=null,n=e.split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");if(i[0]=="goto"&&i.length>1){t=i[1];break}}this.isMainUICommand(t)&&(this.showWelcome=!1)}else window.location.hash="#goto=welcome"},hideWelcome:function(e){this.ieBackButtonFix();var t=document.getElementById("welcome");setVisible(t,!1),coreDispatcher.showWelcome=!1},hideSymatlas:function(e){ga("send","event","SymAtlas","Start BioGPS",e,{nonInteraction:1});if(e.length>0)window.location.href="/?query="+e;else{var t=document.getElementById("symatlas-mask");setVisible(t,!1),t=document.getElementById("symatlas-box"),setVisible(t,!1),document.getElementById("qsearch_query").focus()}},goBacktoSymatlas:function(e){ga("send","event","SymAtlas","Back to SymAtlas",query,{nonInteraction:1}),window.location="http://symatlas.gnf.org/deprecated/"+e},useSampleSearch:function(e,t){t&&(t.cancelBubble=!0);var n=document.getElementById("qsearch_query");n.value=e,n.focus()},bindHotKey:function(){var e=Ext.get("qsearch_form"),t=new Ext.KeyMap(e,{key:13,ctrl:!0,stopEvent:!0,fn:function(){e.dom.onsubmit()},scope:this})},ieBackButtonFix:function(){Ext.isIE&&(Ext.History.suspendEvents(),Ext.History.add("goto=welcome"),Ext.History.resumeEvents())},doSearch_v1:function(e,t){t&&(t.cancelBubble=!0);var n=e.query.value.trim();if(n!=""){var r=e.qtype.value;this.delayedExecute(function(){biogps.Messenger.on("genelistrendered",function(){coreDispatcher.hideWelcome(),biogps.clearListeners(biogps.Messenger,"genelistrendered")}),biogps.doSearch({query:n,qtype:r,searchby:"searchbyanno",target:e.query.id})})}else e.query.value="",e.query.focus()},doSearch:function(e,t){t&&(t.cancelBubble=!0);var n=e.query.value.trim(),r=e.userfilter?e.userfilter.value:null;n!=""?this.delayedExecute(function(){biogps.Messenger.on("genelistrendered",function(){coreDispatcher.hideWelcome(),biogps.clearListeners(biogps.Messenger,"genelistrendered")}),biogps.doSearch({query:n,userfilter:r,target:e.query.id})}):(e.query.value="",e.query.focus())},gotoSearch:function(e){e&&(e.cancelBubble=!0),this.delayedExecute(function(){coreDispatcher.hideWelcome(),Ext.History.add("goto=search")})},doTopBarSearch:function(e,t){t&&(t.cancelBubble=!0);var n=e.topquery.value.trim();return e.topquery.value="",e.topquery.blur(),n!=""&&n!="Quick gene search"&&(ga("send","event","BioGPS","QuickGeneSearch",n,{nonInteraction:1}),window.location="/#goto=search&query="+n),!1},onInputFocus:function(e,t){return t&&(t.cancelBubble=!0),e.value==e.defaultValue&&(e.value="",e.className=""),!1},onInputBlur:function(e,t){return t&&(t.cancelBubble=!0),e.value.trim()==""&&(e.value=e.defaultValue,e.className="inactive"),!1},openid:function(e){var t=document.getElementById("openid_url"),n=document.getElementById("openid_form");ga("send","pageview","/auth/login/openid/"+e),e=="google"?(t.value="https://www.google.com/accounts/o8/id",n.submit()):e=="yahoo"&&(t.value="http://yahoo.com/",n.submit())},onGoogleGroupsSignup:function(e,t){e&&(e.cancelBubble=!0),this.delayedExecute(function(){biogps.subscribeGoogleGroups(e,Ext.get(t))})}},biogps={},biogps.bequietonfailure=!1,window.onbeforeunload=function(){biogps.bequietonfailure=!0}}).call(this);
